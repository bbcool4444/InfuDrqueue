<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>User Data</title>
<meta http-equiv="content-type" content="text/html; charset=us-ascii" />
<meta name="author" content="mental images GmbH" />
<link href="mailto:office@mentalimages.com" rev="made" />
<link href="mental.css" rel="stylesheet" media="all" type="text/css" />
<link rel="shortcut icon" href="mentalicon.ico" type="image/x-icon" />
</head>
<body>
<ul class="nav">
<li><a href="index.html">home</a></li>
<li><a href="map_mi.html">&laquo;&nbsp;prev</a></li>
<li><a href="node82.html">next&nbsp;&raquo;</a></li>
<li><a href="globalindex.html">index</a></li>
</ul>
<a id="SECTION79"></a>
<h3>User Data</h3>
<p><a id="userdata"></a><a id="INDEX265"></a></p>
<pre>
    data "<i>name</i>"  
        [ tag <i>label</i><sub>int</sub> ]  
        <i>bytecount</i><sub>int</sub> [ <i>bytes list</i> ]  
     
    data "<i>name</i>"  
        [ tag <i>label</i><sub>int</sub> ]  
        "<i>filename</i>"  
     
    data "<i>name</i>"  
        [ tag <i>label</i><sub>int</sub> ]  
        <i>declaration_name</i> ( <i>parameters</i> )  
</pre>
<p>User data is arbitrary data stored in the scene file, which can
be passed to shaders as a shader parameter of type <tt>data</tt>.
This is useful for large amounts of data that is shared by several
shaders, or too large or complex to be defined with individual
shader parameters. There are three ways to define user data:</p>
<ul>
<li>as a raw byte list. The list is a sequence of hexadecimal byte
strings, each consisting of pairs of digits in the range 0..f, and
enclosed in single quotes. Each string can be no longer than 1024
bytes (2048 digits); if this is not sufficient more strings must
follow. Note that the angle brackets must be in the scene file
literally. The <i>bytecount</i> is the total byte count in the
square brackets, regardless of how many quoted strings it is split
up into.</li>
<li>as a file name. The file will be opened and its binary contents
are read into memory.</li>
<li>as a structured parameter list. This is the only user data type
that will be properly byte-swapped if used on a network of hosts
with different byte orders. The parameter definition works exactly
like the definition of shader parameters, and also need to be
declared in the same way except that the declaration begins with
"<tt>declare data</tt>" instead of "<tt>declare shader</tt>".</li>
</ul>
<p>Shaders see a tag if they evaluate a parameter of type
<tt>data</tt>. This tag can be accessed with the
<i><a href="miquery.html#api:mi_query">mi_query</a></i> modes <tt>miQ_DATA_*</tt>,
especially <tt>miQ_DATA_PARAM</tt> for accessing the data payload,
and <tt>miQ_DATA_NEEDSWAP</tt> for determining if a raw byte block
(the first two data definition methods) need swapping by the
shader. Note that the result returned by <tt>miQ_DATA_PARAM</tt>
must be cast to the appropriate data type.</p>
<ul class="nav">
<li><a href="index.html">home</a></li>
<li><a href="map_mi.html">&laquo;&nbsp;prev</a></li>
<li><a href="node82.html">next&nbsp;&raquo;</a></li>
<li><a href="globalindex.html">index</a></li>
</ul>
<p><a href="copyright.html">Copyright</a> &copy; 1986-2010 by
<a href="http://www.mental.com">mental images GmbH</a></p>
</body>
</html>
