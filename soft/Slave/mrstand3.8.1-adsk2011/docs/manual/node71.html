<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Commands</title>
<meta http-equiv="content-type" content="text/html; charset=us-ascii" />
<meta name="author" content="mental images GmbH" />
<link href="mailto:office@mentalimages.com" rev="made" />
<link href="mental.css" rel="stylesheet" media="all" type="text/css" />
<link rel="shortcut icon" href="mentalicon.ico" type="image/x-icon" />
</head>
<body>
<ul class="nav">
<li><a href="index.html">home</a></li>
<li><a href="node70.html">&laquo;&nbsp;prev</a></li>
<li><a href="node72.html">next&nbsp;&raquo;</a></li>
<li><a href="globalindex.html">index</a></li>
</ul>
<a id="SECTION69"></a>
<h2>Commands</h2>
<p><a id="INDEX156"></a> Commands are instructions
to mental ray that are executed the moment they are read from the
input scene file. They do not add elements to the scene database.
Since the scene file is only read by the master host in a network
configuration, commands are never seen by slave hosts.<br /></p>
<pre>
    $include "<i>filename</i>"  
    $include &lt;<i>filename</i>&gt;
</pre>
<p><a id="INDEX157"></a> The $ sign must appear in
the first column of the line. The named file is included (pasted
into) the <tt>.mi</tt> file in place of the $include statement.
Includes can be nested. The main purpose is to include declarations
(see below), but materials, light sources, even objects can be
included. The only place where $include cannot be used is between
$<b><a id="INDEX158"></a>code</b> and $end code;
use the standard C #include statement there. The included file is
read on the master host only. If the <i>filename</i> is enclosed in
angle brackets, the standard include path is prepended, by default
<tt>/usr/include</tt>. The standard path can be changed with the
<tt>-I</tt> command-line option.<br /></p>
<a id="INDEX159"></a>
<a id="mi:namespace"></a>
<pre>
    namespace "<i>name</i>"
    <dfn>...</dfn>
    end namespace
</pre>
<p>A namespace bracket can enclose any number of toplevel element
definitions. Any toplevel element name defined and used in this
bracket will be prefixed with "<i>name</i> <tt>::</tt>". For
example, a material named <tt>"mtl"</tt> defined in the bracket
will be named <tt>"name::mtl"</tt>. Inside the bracket it can be
referenced as <tt>"mtl"</tt>, but outside the bracket the full
<tt>"name::mtl"</tt> name must be used. Inside the bracket, global
toplevel elements outside the bracket can be referenced by
prefixing the name with <tt>::</tt>, as in <tt>"::mtl"</tt>.
Namespaces are useful to define subscenes that should not interfere
with other subscenes or the main scene.</p>
<p>Note that all geometry created by a geometry shader is
implicitly defined in a namespace with a unique namespace name that
is automatically generated by mental ray. This is how two geometry
shaders that both create toplevel elements with the same name avoid
interfering with each other.</p>
<p>Note that the <tt>-echo</tt> command-line option does not
reproduce the namespace statements, but instead generates the full
<tt>::</tt> names.</p>
<a id="mi:version"></a>
<pre>
   <dfn>[</dfn>min<dfn>]</dfn> version "<i>string</i>"
    max version "<i>string</i>"
</pre>
<p>This command informs mental ray that this .mi file requires the
given mental ray version. <tt>min</tt> means "at least" and
<tt>max</tt> means "at most". Version strings consist of numbers
separated with dots, such as <tt>"1.2.3.4"</tt>. The string can
underspecify the version, as in <tt>"3.6"</tt>. Missing numbers are
implicitly assumed to be 0 so <tt>"3.6"</tt> becomes
<tt>"3.6.0.0"</tt>. Each number, beginning with the first, is
checked in turn. If the number in the <i>string</i> is greater (
<tt>min</tt>) or less than ( <tt>max</tt>) than the version number
built into mental ray, an error message is printed and mental ray
aborts; otherwise the next number is considered. If all given
numbers pass the test, mental ray continues.</p>
<p>File version numbers are especially useful for declaration
files, such as <tt>base.mi</tt> in the standard distribution. They
are mainly useful for making sure that certain mental ray features
and scene file syntax are present. For example, a scene file using
demand-loaded assembly files may specify <tt>min version
3.6</tt> because that feature was introduced in mental ray 3.6, and
would cause a syntax error in earlier versions. Shaders have their
own version numbers in declarations that are independent of mental
ray version numbers.<br /></p>
<a id="mi:verbose"></a>
<pre>
    verbose on<dfn>|</dfn>off<dfn>|</dfn><i>level</i><sub>int</sub>  
</pre>
<p>This command controls <b><a id="INDEX160"></a>verbose message</b>s.
There are seven levels: fatal
errors (0), errors (1), warnings (2), progress reports (3),
informational messages (4), debugging messages (5), and verbose
debugging messages (6). All message categories numerically less
than <i>level</i> are printed. Verbose <tt>off</tt> is equivalent
to level 2 (fatal errors and errors only); verbose <tt>on</tt> is
equivalent to level 5 (everything except debugging messages).
Verbose messages can slow down mental ray while parsing, especially
on systems with poor I/O systems such as Windows NT because of slow
scrolling. Verbose level 7 should generally be avoided; it prints
information that is really only useful for mental images. The
verbose command can be overridden with the <tt>-verbose</tt>
command-line option.<br /></p>
<a id="mi:echo"></a>
<pre>
    echo "<i>message</i>"  
</pre>
<p>The named <i>message</i>, which must be enclosed in double
quotes, is printed to stdout. The <b><a id="INDEX161"></a>echo</b>
command is executed synchronously during
parsing the .mi file. Echoing requires verbosity level 4 or
higher.<br /></p>
<a id="mi:call"></a>
<pre>
    call <i>shader_list</i> <dfn>[</dfn>, "<i>camera_inst</i>" "<i>options</i>"<dfn>]</dfn>
</pre>
<p>The given shader is called immediately, and parsing stops until
the shader completes. Since the shader is called during parsing and
not during tessellation or rendering, the entire state passed to
the shader is filled with nulls, which limits what the shader can
do (it cannot cast rays, for example). If the name of a camera
instance element and the name of an options element is given,
<code>state&rarr;options</code> and <code>state&rarr;camera</code>
are set up for the shader. The return value is ignored. The call
statement is intended for early initialization of shader packages,
or even to start interactive front-end packages from inside a
standalone mental ray. Shader init and exit functions are not
called by the <tt>call</tt> statement. For shader initialization,
shader init functions are more useful because they are called with
a full state, and only if the corresponding shader is actually
needed. Call statements are rarely used.<br /></p>
<a id="mi:touch"></a>
<pre>
    touch "<i>element_name</i>"
</pre>
<p>Mark the element as modified (or <dfn>dirty</dfn>), similar to an
incremental change. This enforces a full re-evaluation of the element
in a subsequent read access, disregarding any cached values like tessellations.
This is useful when a displacement shader or a connected subshader changes
(mental ray cannot discover this by itself), or when the content of a texture
file has changed on disk and needs to be reloaded.</p>
<a id="mi:system"></a>
<pre>
    system "<i>shell_command</i>"  
</pre>
<p>This command starts a <b><a id="INDEX162"></a>shell</b>, which executes the named
<i>shell_command</i>. The shell command string must be enclosed in
double quotes. The full shell scripting command syntax is
available, including pipes, redirections, control structures, and
environment variables. mental ray waits until the shell command has
completed; this can be defeated by ending the command with a shell
<tt>&amp;</tt> command. The system command is executed while
parsing, not during rendering. Its main purpose is writing finished
pictures to an output device such as a film recorder. Shell
commands are operating-system dependent and are much less useful on
Windows NT because NT shells are severely limited. Note that shell
commands, like shaders, are executed with the privilege of the user
running mental ray.<br /></p>
<a id="mi:delete"></a>
<pre>
    delete "<i>element_name</i>"  
</pre>
<p>Delete a named scene element, such as objects, materials,
lights, textures, instances, and instance groups. Declarations
cannot be deleted. It is possible to delete an element and recreate
it with the same name, but this breaks all links. For example, if a
light is created and then an instance is created for it, naming the
light, the link between instance and light is broken when the light
is deleted and recreated. The instance retains a <i>dangling
link</i> that will cause havoc during later processing. The
<tt>delete</tt> command should be used only for entities that
disappear permanently. All instances and instance groups that
contain the name must be updated <i>before</i> the name is
deleted.</p>
<p>Instead of deleting and recreating an element, an
<a href="node60.html#INDEX110">incremental change</a> should be used by
prefixing the element definition with the <tt>incremental</tt>
modifier. This has the additional advantage that the element
retains all contents that are not modified during the new
incremental definition. For example, an incremental change to a
camera containing nothing but a new <a href="node199.html#INDEX1061">frame
number</a> specification will leave
the camera unchanged except for the frame number. As an exception,
objects and instgroups are cleared first because merging is not
generally useful in these cases.</p>
<a id="mi:debug"></a>
<pre>
    debug "<i>mode</i>" <dfn>[</dfn>"<i>arg</i>"<dfn>]</dfn>
</pre>
<p>Print debug information to the stderr. The verbosity (
<tt>-verbose</tt>) must be set to 4 or higher. Some modes print
information on a specific database element <i>arg</i>. The
following modes are supported:</p>
<div align="center">
<table class="table">
<tr>
<th><i>mode</i></th>
<th><i>arg</i></th>
<th>operation</th>
</tr>
<tr>
<td><tt>sym</tt></td>
<td>-</td>
<td>print all symbol tables</td>
</tr>
<tr>
<td><tt>sym global</tt></td>
<td>-</td>
<td>print the main global symbol table</td>
</tr>
<tr>
<td><tt>sym declare</tt></td>
<td>-</td>
<td>print all declaration symbols</td>
</tr>
<tr>
<td><tt>sym variable</tt></td>
<td>-</td>
<td>print all variables from the <tt>set</tt> command</td>
</tr>
<tr>
<td><tt>sym hardware</tt></td>
<td>-</td>
<td>print all hardware shaders</td>
</tr>
<tr>
<td><tt>registry</tt></td>
<td>-</td>
<td>print all <a href="node72.html#INDEX165">registry</a> command
entries</td>
</tr>
<tr>
<td><tt>mem summary</tt></td>
<td>-</td>
<td>print memory usage summary</td>
</tr>
<tr>
<td><tt>db statistics</tt></td>
<td>-</td>
<td>print scene database tag usage statistics</td>
</tr>
<tr>
<td><tt>db summary</tt></td>
<td>-</td>
<td>print scene database tags by module and type</td>
</tr>
<tr>
<td><tt>db dump</tt></td>
<td>-</td>
<td>print all tags in the scene database</td>
</tr>
<tr>
<td><tt>job statistics</tt></td>
<td>-</td>
<td>print summary of executed jobs</td>
</tr>
<tr>
<td><tt>img verbose</tt></td>
<td>-</td>
<td>turn on debugging for loaded image files</td>
</tr>
<tr>
<td><tt>scene check</tt></td>
<td><i>Y</i></td>
<td>check database consistency of tag</td>
</tr>
<tr>
<td><tt>scene dump</tt></td>
<td><i>Y</i></td>
<td>brief listing of tag hierarchy</td>
</tr>
<tr>
<td><tt>scene alldump</tt></td>
<td><i>Y</i></td>
<td>verbose listing of tag hierarchy</td>
</tr>
<tr>
<td><tt>echo</tt></td>
<td><i>Y</i></td>
<td>echo a tag, like <tt>-echo</tt></td>
</tr>
</table>
</div>
<a id="mi:render"></a>
<pre>
    render "<i>root_instgroup_name</i>" "<i>camera_inst_name</i>" "<i>options_name</i>"  
</pre>
<p>This statement renders the scene.</p>
<p>The name of an options element, a camera instance element (which
must also have been attached to the root instance group), and the
root instance group must be given.</p>
<ul class="nav">
<li><a href="index.html">home</a></li>
<li><a href="node70.html">&laquo;&nbsp;prev</a></li>
<li><a href="node72.html">next&nbsp;&raquo;</a></li>
<li><a href="globalindex.html">index</a></li>
</ul>
<p><a href="copyright.html">Copyright</a> &copy; 1986-2010 by
<a href="http://www.mental.com">mental images GmbH</a></p>
</body>
</html>
